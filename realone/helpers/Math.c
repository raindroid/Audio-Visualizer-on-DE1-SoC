#include "Math.h"
#include <math.h>

static const double COSs[360] = {	
    [0] = 1.0000, 0.9998, 0.9994, 0.9986, 0.9976, 0.9962, 0.9945, 0.9925, 0.9903, 0.9877, 
	[10] = 0.9848, 0.9816, 0.9781, 0.9744, 0.9703, 0.9659, 0.9613, 0.9563, 0.9511, 0.9455, 
	[20] = 0.9397, 0.9336, 0.9272, 0.9205, 0.9135, 0.9063, 0.8988, 0.8910, 0.8829, 0.8746, 
	[30] = 0.8660, 0.8572, 0.8480, 0.8387, 0.8290, 0.8192, 0.8090, 0.7986, 0.7880, 0.7771, 
	[40] = 0.7660, 0.7547, 0.7431, 0.7314, 0.7193, 0.7071, 0.6947, 0.6820, 0.6691, 0.6561, 
	[50] = 0.6428, 0.6293, 0.6157, 0.6018, 0.5878, 0.5736, 0.5592, 0.5446, 0.5299, 0.5150, 
	[60] = 0.5000, 0.4848, 0.4695, 0.4540, 0.4384, 0.4226, 0.4067, 0.3907, 0.3746, 0.3584, 
	[70] = 0.3420, 0.3256, 0.3090, 0.2924, 0.2756, 0.2588, 0.2419, 0.2250, 0.2079, 0.1908, 
	[80] = 0.1736, 0.1564, 0.1392, 0.1219, 0.1045, 0.0872, 0.0698, 0.0523, 0.0349, 0.0175, 
	[90] = 0.0000, -0.0175, -0.0349, -0.0523, -0.0698, -0.0872, -0.1045, -0.1219, -0.1392, -0.1564, 
	[100] = -0.1736, -0.1908, -0.2079, -0.2250, -0.2419, -0.2588, -0.2756, -0.2924, -0.3090, -0.3256, 
	[110] = -0.3420, -0.3584, -0.3746, -0.3907, -0.4067, -0.4226, -0.4384, -0.4540, -0.4695, -0.4848, 
	[120] = -0.5000, -0.5150, -0.5299, -0.5446, -0.5592, -0.5736, -0.5878, -0.6018, -0.6157, -0.6293, 
	[130] = -0.6428, -0.6561, -0.6691, -0.6820, -0.6947, -0.7071, -0.7193, -0.7314, -0.7431, -0.7547, 
	[140] = -0.7660, -0.7771, -0.7880, -0.7986, -0.8090, -0.8192, -0.8290, -0.8387, -0.8480, -0.8572, 
	[150] = -0.8660, -0.8746, -0.8829, -0.8910, -0.8988, -0.9063, -0.9135, -0.9205, -0.9272, -0.9336, 
	[160] = -0.9397, -0.9455, -0.9511, -0.9563, -0.9613, -0.9659, -0.9703, -0.9744, -0.9781, -0.9816, 
	[170] = -0.9848, -0.9877, -0.9903, -0.9925, -0.9945, -0.9962, -0.9976, -0.9986, -0.9994, -0.9998, 
	[180] = -1.0000, -0.9998, -0.9994, -0.9986, -0.9976, -0.9962, -0.9945, -0.9925, -0.9903, -0.9877, 
	[190] = -0.9848, -0.9816, -0.9781, -0.9744, -0.9703, -0.9659, -0.9613, -0.9563, -0.9511, -0.9455, 
	[200] = -0.9397, -0.9336, -0.9272, -0.9205, -0.9135, -0.9063, -0.8988, -0.8910, -0.8829, -0.8746, 
	[210] = -0.8660, -0.8572, -0.8480, -0.8387, -0.8290, -0.8192, -0.8090, -0.7986, -0.7880, -0.7771, 
	[220] = -0.7660, -0.7547, -0.7431, -0.7314, -0.7193, -0.7071, -0.6947, -0.6820, -0.6691, -0.6561, 
	[230] = -0.6428, -0.6293, -0.6157, -0.6018, -0.5878, -0.5736, -0.5592, -0.5446, -0.5299, -0.5150, 
	[240] = -0.5000, -0.4848, -0.4695, -0.4540, -0.4384, -0.4226, -0.4067, -0.3907, -0.3746, -0.3584, 
	[250] = -0.3420, -0.3256, -0.3090, -0.2924, -0.2756, -0.2588, -0.2419, -0.2250, -0.2079, -0.1908, 
	[260] = -0.1736, -0.1564, -0.1392, -0.1219, -0.1045, -0.0872, -0.0698, -0.0523, -0.0349, -0.0175, 
	[270] = -0.0000, 0.0175, 0.0349, 0.0523, 0.0698, 0.0872, 0.1045, 0.1219, 0.1392, 0.1564, 
	[280] = 0.1736, 0.1908, 0.2079, 0.2250, 0.2419, 0.2588, 0.2756, 0.2924, 0.3090, 0.3256, 
	[290] = 0.3420, 0.3584, 0.3746, 0.3907, 0.4067, 0.4226, 0.4384, 0.4540, 0.4695, 0.4848, 
	[300] = 0.5000, 0.5150, 0.5299, 0.5446, 0.5592, 0.5736, 0.5878, 0.6018, 0.6157, 0.6293, 
	[310] = 0.6428, 0.6561, 0.6691, 0.6820, 0.6947, 0.7071, 0.7193, 0.7314, 0.7431, 0.7547, 
	[320] = 0.7660, 0.7771, 0.7880, 0.7986, 0.8090, 0.8192, 0.8290, 0.8387, 0.8480, 0.8572, 
	[330] = 0.8660, 0.8746, 0.8829, 0.8910, 0.8988, 0.9063, 0.9135, 0.9205, 0.9272, 0.9336, 
	[340] = 0.9397, 0.9455, 0.9511, 0.9563, 0.9613, 0.9659, 0.9703, 0.9744, 0.9781, 0.9816, 
	[350] = 0.9848, 0.9877, 0.9903, 0.9925, 0.9945, 0.9962, 0.9976, 0.9986, 0.9994, 0.9998
};
static const double SINs[360] = {
    [0] = 0.0000, 0.0175, 0.0349, 0.0523, 0.0698, 0.0872, 0.1045, 0.1219, 0.1392, 0.1564, 
	[10] = 0.1736, 0.1908, 0.2079, 0.2250, 0.2419, 0.2588, 0.2756, 0.2924, 0.3090, 0.3256, 
	[20] = 0.3420, 0.3584, 0.3746, 0.3907, 0.4067, 0.4226, 0.4384, 0.4540, 0.4695, 0.4848, 
	[30] = 0.5000, 0.5150, 0.5299, 0.5446, 0.5592, 0.5736, 0.5878, 0.6018, 0.6157, 0.6293, 
	[40] = 0.6428, 0.6561, 0.6691, 0.6820, 0.6947, 0.7071, 0.7193, 0.7314, 0.7431, 0.7547, 
	[50] = 0.7660, 0.7771, 0.7880, 0.7986, 0.8090, 0.8192, 0.8290, 0.8387, 0.8480, 0.8572, 
	[60] = 0.8660, 0.8746, 0.8829, 0.8910, 0.8988, 0.9063, 0.9135, 0.9205, 0.9272, 0.9336, 
	[70] = 0.9397, 0.9455, 0.9511, 0.9563, 0.9613, 0.9659, 0.9703, 0.9744, 0.9781, 0.9816, 
	[80] = 0.9848, 0.9877, 0.9903, 0.9925, 0.9945, 0.9962, 0.9976, 0.9986, 0.9994, 0.9998, 
	[90] = 1.0000, 0.9998, 0.9994, 0.9986, 0.9976, 0.9962, 0.9945, 0.9925, 0.9903, 0.9877, 
	[100] = 0.9848, 0.9816, 0.9781, 0.9744, 0.9703, 0.9659, 0.9613, 0.9563, 0.9511, 0.9455, 
	[110] = 0.9397, 0.9336, 0.9272, 0.9205, 0.9135, 0.9063, 0.8988, 0.8910, 0.8829, 0.8746, 
	[120] = 0.8660, 0.8572, 0.8480, 0.8387, 0.8290, 0.8192, 0.8090, 0.7986, 0.7880, 0.7771, 
	[130] = 0.7660, 0.7547, 0.7431, 0.7314, 0.7193, 0.7071, 0.6947, 0.6820, 0.6691, 0.6561, 
	[140] = 0.6428, 0.6293, 0.6157, 0.6018, 0.5878, 0.5736, 0.5592, 0.5446, 0.5299, 0.5150, 
	[150] = 0.5000, 0.4848, 0.4695, 0.4540, 0.4384, 0.4226, 0.4067, 0.3907, 0.3746, 0.3584, 
	[160] = 0.3420, 0.3256, 0.3090, 0.2924, 0.2756, 0.2588, 0.2419, 0.2250, 0.2079, 0.1908, 
	[170] = 0.1736, 0.1564, 0.1392, 0.1219, 0.1045, 0.0872, 0.0698, 0.0523, 0.0349, 0.0175, 
	[180] = 0.0000, -0.0175, -0.0349, -0.0523, -0.0698, -0.0872, -0.1045, -0.1219, -0.1392, -0.1564, 
	[190] = -0.1736, -0.1908, -0.2079, -0.2250, -0.2419, -0.2588, -0.2756, -0.2924, -0.3090, -0.3256, 
	[200] = -0.3420, -0.3584, -0.3746, -0.3907, -0.4067, -0.4226, -0.4384, -0.4540, -0.4695, -0.4848, 
	[210] = -0.5000, -0.5150, -0.5299, -0.5446, -0.5592, -0.5736, -0.5878, -0.6018, -0.6157, -0.6293, 
	[220] = -0.6428, -0.6561, -0.6691, -0.6820, -0.6947, -0.7071, -0.7193, -0.7314, -0.7431, -0.7547, 
	[230] = -0.7660, -0.7771, -0.7880, -0.7986, -0.8090, -0.8192, -0.8290, -0.8387, -0.8480, -0.8572, 
	[240] = -0.8660, -0.8746, -0.8829, -0.8910, -0.8988, -0.9063, -0.9135, -0.9205, -0.9272, -0.9336, 
	[250] = -0.9397, -0.9455, -0.9511, -0.9563, -0.9613, -0.9659, -0.9703, -0.9744, -0.9781, -0.9816, 
	[260] = -0.9848, -0.9877, -0.9903, -0.9925, -0.9945, -0.9962, -0.9976, -0.9986, -0.9994, -0.9998, 
	[270] = -1.0000, -0.9998, -0.9994, -0.9986, -0.9976, -0.9962, -0.9945, -0.9925, -0.9903, -0.9877, 
	[280] = -0.9848, -0.9816, -0.9781, -0.9744, -0.9703, -0.9659, -0.9613, -0.9563, -0.9511, -0.9455, 
	[290] = -0.9397, -0.9336, -0.9272, -0.9205, -0.9135, -0.9063, -0.8988, -0.8910, -0.8829, -0.8746, 
	[300] = -0.8660, -0.8572, -0.8480, -0.8387, -0.8290, -0.8192, -0.8090, -0.7986, -0.7880, -0.7771, 
	[310] = -0.7660, -0.7547, -0.7431, -0.7314, -0.7193, -0.7071, -0.6947, -0.6820, -0.6691, -0.6561, 
	[320] = -0.6428, -0.6293, -0.6157, -0.6018, -0.5878, -0.5736, -0.5592, -0.5446, -0.5299, -0.5150, 
	[330] = -0.5000, -0.4848, -0.4695, -0.4540, -0.4384, -0.4226, -0.4067, -0.3907, -0.3746, -0.3584, 
	[340] = -0.3420, -0.3256, -0.3090, -0.2924, -0.2756, -0.2588, -0.2419, -0.2250, -0.2079, -0.1908, 
	[350] = -0.1736, -0.1564, -0.1392, -0.1219, -0.1045, -0.0872, -0.0698, -0.0523, -0.0349, -0.0175
};

static const int SIN_large[360] = {
    [0] =     0,  1143,  2287,  3429,  4571,  5711,  6850,  7986,  9120, 10252, 
	[10] = 11380, 12504, 13625, 14742, 15854, 16961, 18064, 19160, 20251, 21336, 
	[20] = 22414, 23486, 24550, 25606, 26655, 27696, 28729, 29752, 30767, 31772, 
	[30] = 32767, 33753, 34728, 35693, 36647, 37589, 38521, 39440, 40347, 41243, 
	[40] = 42125, 42995, 43852, 44695, 45525, 46340, 47142, 47929, 48702, 49460, 
	[50] = 50203, 50931, 51643, 52339, 53019, 53683, 54331, 54963, 55577, 56175, 
	[60] = 56755, 57319, 57864, 58393, 58903, 59395, 59870, 60326, 60763, 61183, 
	[70] = 61583, 61965, 62328, 62672, 62997, 63302, 63589, 63856, 64103, 64331, 
	[80] = 64540, 64729, 64898, 65047, 65176, 65286, 65376, 65446, 65496, 65526, 
	[90] = 65536, 65526, 65496, 65446, 65376, 65286, 65176, 65047, 64898, 64729, 
	[100] = 64540, 64331, 64103, 63856, 63589, 63302, 62997, 62672, 62328, 61965, 
	[110] = 61583, 61183, 60763, 60326, 59870, 59395, 58903, 58393, 57864, 57319, 
	[120] = 56755, 56175, 55577, 54963, 54331, 53683, 53019, 52339, 51643, 50931, 
	[130] = 50203, 49460, 48702, 47929, 47142, 46340, 45525, 44695, 43852, 42995, 
	[140] = 42125, 41243, 40347, 39440, 38521, 37589, 36647, 35693, 34728, 33753, 
	[150] = 32767, 31772, 30767, 29752, 28729, 27696, 26655, 25606, 24550, 23486, 
	[160] = 22414, 21336, 20251, 19160, 18064, 16961, 15854, 14742, 13625, 12504, 
	[170] = 11380, 10252,  9120,  7986,  6850,  5711,  4571,  3429,  2287,  1143, 
	[180] =     0, -1143, -2287, -3429, -4571, -5711, -6850, -7986, -9120, -10252, 
	[190] = -11380, -12504, -13625, -14742, -15854, -16961, -18064, -19160, -20251, -21336, 
	[200] = -22414, -23486, -24550, -25606, -26655, -27696, -28729, -29752, -30767, -31772, 
	[210] = -32768, -33753, -34728, -35693, -36647, -37589, -38521, -39440, -40347, -41243, 
	[220] = -42125, -42995, -43852, -44695, -45525, -46340, -47142, -47929, -48702, -49460, 
	[230] = -50203, -50931, -51643, -52339, -53019, -53683, -54331, -54963, -55577, -56175, 
	[240] = -56755, -57319, -57864, -58393, -58903, -59395, -59870, -60326, -60763, -61183, 
	[250] = -61583, -61965, -62328, -62672, -62997, -63302, -63589, -63856, -64103, -64331, 
	[260] = -64540, -64729, -64898, -65047, -65176, -65286, -65376, -65446, -65496, -65526, 
	[270] = -65536, -65526, -65496, -65446, -65376, -65286, -65176, -65047, -64898, -64729, 
	[280] = -64540, -64331, -64103, -63856, -63589, -63302, -62997, -62672, -62328, -61965, 
	[290] = -61583, -61183, -60763, -60326, -59870, -59395, -58903, -58393, -57864, -57319, 
	[300] = -56755, -56175, -55577, -54963, -54331, -53683, -53019, -52339, -51643, -50931, 
	[310] = -50203, -49460, -48702, -47929, -47142, -46340, -45525, -44695, -43852, -42995, 
	[320] = -42125, -41243, -40347, -39440, -38521, -37589, -36647, -35693, -34728, -33753, 
	[330] = -32768, -31772, -30767, -29752, -28729, -27696, -26655, -25606, -24550, -23486, 
	[340] = -22414, -21336, -20251, -19160, -18064, -16961, -15854, -14742, -13625, -12504, 
	[350] = -11380, -10252, -9120, -7986, -6850, -5711, -4571, -3429, -2287, -1143
};

static const int COS_large[360] = {
	[0] = 65536, 65526, 65496, 65446, 65376, 65286, 65176, 65047, 64898, 64729, 
	[10] = 64540, 64331, 64103, 63856, 63589, 63302, 62997, 62672, 62328, 61965, 
	[20] = 61583, 61183, 60763, 60326, 59870, 59395, 58903, 58393, 57864, 57319, 
	[30] = 56755, 56175, 55577, 54963, 54331, 53683, 53019, 52339, 51643, 50931, 
	[40] = 50203, 49460, 48702, 47929, 47142, 46340, 45525, 44695, 43852, 42995, 
	[50] = 42125, 41243, 40347, 39440, 38521, 37589, 36647, 35693, 34728, 33753, 
	[60] = 32768, 31772, 30767, 29752, 28729, 27696, 26655, 25606, 24550, 23486, 
	[70] = 22414, 21336, 20251, 19160, 18064, 16961, 15854, 14742, 13625, 12504, 
	[80] = 11380, 10252,  9120,  7986,  6850,  5711,  4571,  3429,  2287,  1143, 
	[90] =     0, -1143, -2287, -3429, -4571, -5711, -6850, -7986, -9120, -10252, 
	[100] = -11380, -12504, -13625, -14742, -15854, -16961, -18064, -19160, -20251, -21336, 
	[110] = -22414, -23486, -24550, -25606, -26655, -27696, -28729, -29752, -30767, -31772, 
	[120] = -32767, -33753, -34728, -35693, -36647, -37589, -38521, -39440, -40347, -41243, 
	[130] = -42125, -42995, -43852, -44695, -45525, -46340, -47142, -47929, -48702, -49460, 
	[140] = -50203, -50931, -51643, -52339, -53019, -53683, -54331, -54963, -55577, -56175, 
	[150] = -56755, -57319, -57864, -58393, -58903, -59395, -59870, -60326, -60763, -61183, 
	[160] = -61583, -61965, -62328, -62672, -62997, -63302, -63589, -63856, -64103, -64331, 
	[170] = -64540, -64729, -64898, -65047, -65176, -65286, -65376, -65446, -65496, -65526, 
	[180] = -65536, -65526, -65496, -65446, -65376, -65286, -65176, -65047, -64898, -64729, 
	[190] = -64540, -64331, -64103, -63856, -63589, -63302, -62997, -62672, -62328, -61965, 
	[200] = -61583, -61183, -60763, -60326, -59870, -59395, -58903, -58393, -57864, -57319, 
	[210] = -56755, -56175, -55577, -54963, -54331, -53683, -53019, -52339, -51643, -50931, 
	[220] = -50203, -49460, -48702, -47929, -47142, -46340, -45525, -44695, -43852, -42995, 
	[230] = -42125, -41243, -40347, -39440, -38521, -37589, -36647, -35693, -34728, -33753, 
	[240] = -32768, -31772, -30767, -29752, -28729, -27696, -26655, -25606, -24550, -23486, 
	[250] = -22414, -21336, -20251, -19160, -18064, -16961, -15854, -14742, -13625, -12504, 
	[260] = -11380, -10252, -9120, -7986, -6850, -5711, -4571, -3429, -2287, -1143, 
	[270] =     0,  1143,  2287,  3429,  4571,  5711,  6850,  7986,  9120, 10252, 
	[280] = 11380, 12504, 13625, 14742, 15854, 16961, 18064, 19160, 20251, 21336, 
	[290] = 22414, 23486, 24550, 25606, 26655, 27696, 28729, 29752, 30767, 31772, 
	[300] = 32768, 33753, 34728, 35693, 36647, 37589, 38521, 39440, 40347, 41243, 
	[310] = 42125, 42995, 43852, 44695, 45525, 46340, 47142, 47929, 48702, 49460, 
	[320] = 50203, 50931, 51643, 52339, 53019, 53683, 54331, 54963, 55577, 56175, 
	[330] = 56755, 57319, 57864, 58393, 58903, 59395, 59870, 60326, 60763, 61183, 
	[340] = 61583, 61965, 62328, 62672, 62997, 63302, 63589, 63856, 64103, 64331, 
	[350] = 64540, 64729, 64898, 65047, 65176, 65286, 65376, 65446, 65496, 65526
};

double VIS_FastSin_r(double rad) {
    return VIS_FastSin_d(rad * VIS_R2D);
}

double VIS_FastSin_d(double deg) {
    int degree = ((int) deg) % 360;
    return SINs[degree];
    // return sin(deg * VIS_D2R);
}

double VIS_FastCos_r(double rad) {
    return VIS_FastCos_d(rad * VIS_R2D);
}

double VIS_FastCos_d(double deg) {
    int degree = ((int) deg) % 360;
    return COSs[degree];
    // return cos(deg * VIS_D2R);
}

int VIS_FastSin_d16(int deg) {
    int degree = deg % 360;
    return SIN_large[degree];
}

int VIS_FastSin_r16(int rad) {
	int degree = ((rad * VIS_R2D_16) >> 24) % 360;
	return SIN_large[degree];
}

int VIS_FastCos_d16(int deg) {
    int degree = deg % 360;
    return COS_large[degree];
}

int VIS_FastCos_r16(int rad) {
	int degree = ((rad * VIS_R2D_16) >> 16) % 360;
	return COS_large[degree];
}